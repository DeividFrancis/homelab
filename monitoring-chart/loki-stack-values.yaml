loki-stack:
  loki:
    enabled: true
    persistence:
      enabled: true
      size: 1Gi

  promtail:
    enabled: true
    config:
      clients:
        - url: http://{{ .Release.Name }}-loki:3100/loki/api/v1/push

  prometheus:
    enabled: true

  grafana:
    enabled: true

    sidecar:
      datasources:
        enabled: true
        initDatasources: true
    podAnnotations:
      annotations: |
      vault.hashicorp.com/role: "role-monitoring"
      vault.hashicorp.com/agent-init-first: "true"
      vault.hashicorp.com/agent-inject: "true"
      vault.hashicorp.com/agent-inject-status: "update"
      vault.hashicorp.com/agent-inject-secret-monitoring: "pantulab/monitoring"
      vault.hashicorp.com/agent-inject-template-password: |
        {{- with secret "pantulab/monitoring" -}}
          {{ .Data.data.grafana_password }}
        {{- end }}
    env:
      GF_SECURITY_ADMIN_USER: admin
      GF_SECURITY_ADMIN_PASSWORD__FILE: /vault/secrets/password
    service:
      type: ClusterIP
